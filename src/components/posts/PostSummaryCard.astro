---
import type { CollectionEntry } from 'astro:content';
import { Card, Pill, Button } from '@eliancodes/brutal-ui';
import { Image } from 'astro:assets';

interface Props {
  post: CollectionEntry<'posts'>;
  index?: number;
}

const { post, index = 0 } = Astro.props;
const { data } = post;
const isInitialLoad = index < 15;
---

<Card color='white'>
  <h3 class='poppins text-lg md:text-xl'>{data.title}</h3>
  <div class='rounded-lg border-3 border-black my-4 h-56'>
    <Image
      src={data.imgUrl}
      alt={data.title}
      width={800}
      height={400}
      loading={isInitialLoad ? "eager" : "lazy"}
      decoding={isInitialLoad ? "sync" : "async"}
      class='rounded h-full w-full object-cover'
    />
  </div>
  <p class='poppins'>{data.description}</p>

  <div class='flex justify-end my-4'>
    <Button href={`/${post.id}/`}>Lire plus &rarr;</Button>
  </div>

  <div class='hidden sm:inline-block'>
    <div class='flex justify-between items-center'>
      <ul class='flex flex-wrap gap-4 mt-2'>
        {
          data.tags.map((tag) => (
            <li>
              <a class="sanchez" href={`/tag/${tag.toLowerCase()}/`}>
                <Pill>{tag}</Pill>
              </a>
            </li>
          ))
        }
      </ul>
      {
        data.draft && (
          <span class='bg-green rounded-full border-2 py-1 px-4 text-sm border-black card-shadow'>
            Brouillon
          </span>
        )
      }
    </div>
  </div>
</Card>
